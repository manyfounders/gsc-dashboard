# Настройка Firebase для системы комментариев

## Проблема с индексами

При использовании системы комментариев Firebase может требовать создания составных индексов для оптимизации запросов. Это происходит при использовании запросов с фильтрацией и сортировкой одновременно.

## Автоматическое создание индекса

Firebase автоматически предлагает создать необходимый индекс. В консоли браузера вы увидите ссылку вида:

```
https://console.firebase.google.com/v1/r/project/gcs-dashboard-0/firestore/indexes?create_composite=...
```

## Ручное создание индекса

Если автоматическая ссылка не работает, создайте индекс вручную:

1. Откройте [Firebase Console](https://console.firebase.google.com)
2. Выберите проект `gcs-dashboard-0`
3. Перейдите в **Firestore Database** → **Indexes**
4. Нажмите **Create Index**
5. Настройте индекс:
   - **Collection ID**: `site_comments`
   - **Fields**:
     - `siteUrl` (Ascending)
     - `createdAt` (Descending)
   - **Query scope**: Collection

## Структура данных комментариев

```typescript
interface Comment {
  id: string;
  siteUrl: string;
  content: string;
  userName: string;
  userEmail: string;
  userAvatar?: string;
  createdAt: Timestamp;
  updatedAt?: Timestamp;
}
```

## Fallback логика

Если индекс еще не создан, система использует fallback логику:
1. Получает все комментарии для сайта без сортировки
2. Сортирует их на клиенте по дате создания
3. Отображает результат пользователю

## Проверка работы

После создания индекса:
1. Перезагрузите страницу
2. Проверьте консоль браузера - ошибки с индексами должны исчезнуть
3. Система комментариев должна работать корректно

## Время создания индекса

Создание индекса может занять несколько минут. В это время система будет использовать fallback логику. 